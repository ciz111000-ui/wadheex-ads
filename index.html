<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wadheex X</title>

<link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet"/>
<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>

<style>
:root{
  --purple:#8a2be2;
  --purple2:#b26cff;
  --bg:#0b0b15;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:#fff;font-family:system-ui}

/* HERO */
.hero{
  height:100vh;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 8%;
  background:linear-gradient(135deg,#0b0b15,#151528);
}
.hero h1{font-size:46px;margin:0 0 20px}
.cta{
  padding:14px 22px;
  background:linear-gradient(90deg,var(--purple),var(--purple2));
  border-radius:10px;
  cursor:pointer;
}
.hero-right{
  width:320px;height:580px;
  border-radius:20px;
  background:#000;
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 40px 80px rgba(0,0,0,.7);
}

/* MAP */
.map-section{height:100vh;position:relative}
#map{position:absolute;inset:0;width:100%;height:100%}

/* PANEL */
.panel{
  position:absolute;
  top:0;right:0;
  height:100%;
  width:380px;
  background:#12121d;
  padding:30px;
  transform:translateX(100%);
  transition:.4s;
  z-index:10;
}
.panel.active{transform:translateX(0)}
.toggle{
  position:absolute;
  top:50%;
  right:380px;
  transform:translateY(-50%);
  background:var(--purple);
  padding:12px;
  cursor:pointer;
}
.panel input{
  width:100%;
  padding:12px;
  margin:10px 0;
  background:#0f0f18;
  border:1px solid #222;
  color:#fff;
}
.panel button{
  width:100%;
  padding:14px;
  background:linear-gradient(90deg,var(--purple),var(--purple2));
  border:none;
  cursor:pointer;
}
.panel button:disabled{opacity:.5}

/* MOBILE */
@media(max-width:900px){
  .hero{flex-direction:column;text-align:center}
  .panel{
    width:100%;
    height:55%;
    bottom:0;
    top:auto;
    transform:translateY(100%);
    border-radius:20px 20px 0 0;
  }
  .panel.active{transform:translateY(0)}
  .toggle{
    top:auto;
    bottom:55%;
    right:50%;
    transform:translateX(50%);
  }
}
</style>
</head>
<body>

<section class="hero">
  <div>
    <h1>Ø§Ø­Ø¬Ø² Ø¥Ø¹Ù„Ø§Ù†Ùƒ Ø¯Ø§Ø®Ù„ Ù†Ø·Ø§Ù‚ 10 Ø¯Ù‚Ø§Ø¦Ù‚</h1>
    <div class="cta" onclick="scrollToMap()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø­Ø¬Ø²</div>
  </div>
  <div class="hero-right">WADHEEX LED</div>
</section>

<section class="map-section" id="mapSection">
  <div id="map"></div>
  <div class="toggle" onclick="togglePanel()">â˜°</div>

  <div class="panel" id="panel">
    <h3>Ø·Ù„Ø¨ Ø¥Ø¹Ù„Ø§Ù† (Ø£Ø³Ø¨ÙˆØ¹)</h3>
    <input id="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø´Ø£Ø©"/>
    <input id="date" type="date"/>
    <div id="priceBox">Ø§Ø®ØªØ± Ù…ÙˆÙ‚Ø¹ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©</div>
    <button id="submitBtn" disabled onclick="submitAd()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
  </div>
</section>

<script>
// âœ… ØªÙˆÙƒÙ† Mapbox Ù…Ø«Ø¨Øª
mapboxgl.accessToken="pk.eyJ1IjoibjktN3Z2IiwiYSI6ImNtbTJubnJjMDA4OGEycXNnaXN2M21lZ3QifQ.yZPWMAgrnQxnwZZdr8kwjA";

// ğŸ” Ø­Ø· ØªÙˆÙƒÙ† Telegram Ù‡Ù†Ø§
const TELEGRAM_BOT_TOKEN="7991701749:AAE57vt1JB4gB4lLwRsRXfTEmvuFBMEjqcI";
const TELEGRAM_CHAT_ID="735805031";

const circleRadius=8;

const screens=[
 {name:"Screen Ø§Ù„Ù†Ø®ÙŠÙ„",coords:[46.67,24.74]},
 {name:"Screen Ø§Ù„Ù…Ù„Ù‚Ø§",coords:[46.63,24.79]},
 {name:"Screen Ø§Ù„ÙŠØ§Ø³Ù…ÙŠÙ†",coords:[46.70,24.78]}
];

let selectedPoint=null;
let selectedScreen=null;
let circleIds=[];

const map=new mapboxgl.Map({
 container:"map",
 style:"mapbox://styles/mapbox/dark-v11",
 center:[46.67,24.75],
 zoom:11
});

map.on("load",()=>{

 screens.forEach((screen,index)=>{

  new mapboxgl.Marker({color:"#8a2be2"})
   .setLngLat(screen.coords)
   .addTo(map);

  const circle=turf.circle(screen.coords,circleRadius,{
   steps:80,
   units:"kilometers"
  });

  const id="circle-"+index;
  circleIds.push(id);

  map.addSource(id,{type:"geojson",data:circle});

  map.addLayer({
   id:id+"-fill",
   type:"fill",
   source:id,
   paint:{
    "fill-color":"#8a2be2",
    "fill-opacity":0.2
   }
  });

  map.addLayer({
   id:id+"-line",
   type:"line",
   source:id,
   paint:{
    "line-color":"#b26cff",
    "line-width":2
   }
  });

 });

});

map.on("click",e=>{
 selectedPoint=[e.lngLat.lng,e.lngLat.lat];

 if(window.userMarker)window.userMarker.remove();
 window.userMarker=new mapboxgl.Marker({color:"#00bfff"})
  .setLngLat(selectedPoint)
  .addTo(map);

 calculate();
});

function calculate(){

 let inside=false;
 let min=999;
 let closestIndex=null;

 screens.forEach((screen,index)=>{
  const d=turf.distance(
   turf.point(selectedPoint),
   turf.point(screen.coords),
   {units:"kilometers"}
  );

  if(d<=circleRadius){
   inside=true;
   if(d<min){
    min=d;
    closestIndex=index;
    selectedScreen=screen;
   }
  }
 });

 circleIds.forEach(id=>{
  map.setPaintProperty(id+"-fill","fill-opacity",0.15);
  map.setPaintProperty(id+"-line","line-width",2);
 });

 const priceBox=document.getElementById("priceBox");
 const btn=document.getElementById("submitBtn");

 if(!inside){
  priceBox.innerText="âŒ Ø®Ø§Ø±Ø¬ Ù†Ø·Ø§Ù‚ Ø§Ù„ØªØºØ·ÙŠØ©";
  btn.disabled=true;
  return;
 }

 const activeId=circleIds[closestIndex];
 map.setPaintProperty(activeId+"-fill","fill-opacity",0.4);
 map.setPaintProperty(activeId+"-line","line-width",4);

 let price=min<=2?4000:min<=5?3000:2000;
 priceBox.innerHTML="Ø§Ù„Ø³Ø¹Ø±: "+price+" Ø±ÙŠØ§Ù„<br>Ù…Ø¯Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†: Ø£Ø³Ø¨ÙˆØ¹";

 btn.disabled=false;
}

function togglePanel(){
 document.getElementById("panel").classList.toggle("active");
}

function scrollToMap(){
 document.getElementById("mapSection")
 .scrollIntoView({behavior:"smooth"});
}

function submitAd(){
 alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ ğŸš€");
}
</script>

</body>
</html>
